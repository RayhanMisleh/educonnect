(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[711],{4356:(e,r,t)=>{Promise.resolve().then(t.bind(t,6639))},5695:(e,r,t)=>{"use strict";var a=t(8999);t.o(a,"usePathname")&&t.d(r,{usePathname:function(){return a.usePathname}}),t.o(a,"useRouter")&&t.d(r,{useRouter:function(){return a.useRouter}})},6024:(e,r,t)=>{"use strict";t.d(r,{AuthProvider:()=>i,A:()=>u});var a=t(5155),s=t(2115);class n{async createUser(e,r,t){try{let a=await fetch(this.baseUrl,{method:"POST",headers:this.headers,body:JSON.stringify({fields:{name:e,email:r,senha:t}})});if(!a.ok)throw Error("HTTP error! status: ".concat(a.status));let s=await a.json();return{id:s.id,name:s.fields.name,email:s.fields.email}}catch(e){return console.error("Error creating user:",e),null}}async authenticateUser(e,r){try{let t=await fetch("".concat(this.baseUrl,"?filterByFormula={email}='").concat(e,"'"),{headers:this.headers});if(!t.ok)throw Error("HTTP error! status: ".concat(t.status));let a=await t.json();if(0===a.records.length)return null;let s=a.records[0];if(s.fields.senha===r)return{id:s.id,name:s.fields.name,email:s.fields.email};return null}catch(e){return console.error("Error authenticating user:",e),null}}async getUserById(e){try{let r=await fetch("".concat(this.baseUrl,"/").concat(e),{headers:this.headers});if(!r.ok)throw Error("HTTP error! status: ".concat(r.status));let t=await r.json();return{id:t.id,name:t.fields.name,email:t.fields.email}}catch(e){return console.error("Error getting user:",e),null}}async checkEmailExists(e){try{let r=await fetch("".concat(this.baseUrl,"?filterByFormula={email}='").concat(e,"'"),{headers:this.headers});if(!r.ok)throw Error("HTTP error! status: ".concat(r.status));return(await r.json()).records.length>0}catch(e){return console.error("Error checking email:",e),!1}}constructor(){this.baseUrl="https://api.airtable.com/v0/".concat("appUeGOeOVMrVnvbq","/").concat("users"),this.headers={Authorization:"Bearer ".concat("pat5cVsVJ4Tp5gLRz.339caab494d19621e8613114a81cf4d3042a3db9573d189acdd1b5a9f71ee79d"),"Content-Type":"application/json"}}}let o=new n,c=(0,s.createContext)(void 0);function i(e){let{children:r}=e,[t,n]=(0,s.useState)(null),[i,u]=(0,s.useState)(!0);(0,s.useEffect)(()=>{(async()=>{let e=localStorage.getItem("educonnect_user");if(e)try{let r=JSON.parse(e),t=await o.getUserById(r.id);t?n(t):localStorage.removeItem("educonnect_user")}catch(e){console.error("Error validating saved user:",e),localStorage.removeItem("educonnect_user")}u(!1)})()},[]);let l=async(e,r)=>{try{let t=await o.authenticateUser(e,r);if(t)return n(t),localStorage.setItem("educonnect_user",JSON.stringify(t)),!0;return!1}catch(e){return console.error("Login error:",e),!1}},d=async(e,r,t)=>{try{if(await o.checkEmailExists(r))return!1;let a=await o.createUser(e,r,t);if(a)return n(a),localStorage.setItem("educonnect_user",JSON.stringify(a)),!0;return!1}catch(e){return console.error("Signup error:",e),!1}};return(0,a.jsx)(c.Provider,{value:{user:t,login:l,signup:d,logout:()=>{n(null),localStorage.removeItem("educonnect_user")},isLoading:i},children:r})}function u(){let e=(0,s.useContext)(c);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},6639:(e,r,t)=>{"use strict";t.d(r,{ProtectedRoute:()=>c});var a=t(5155),s=t(6024),n=t(5695),o=t(2115);function c(e){let{children:r}=e,{user:t,isLoading:c}=(0,s.A)(),i=(0,n.useRouter)();return((0,o.useEffect)(()=>{c||t||i.push("/login")},[t,c,i]),c)?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-background",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),(0,a.jsx)("p",{className:"font-mono text-sm text-foreground/60",children:"Carregando..."})]})}):t?(0,a.jsx)(a.Fragment,{children:r}):null}}},e=>{var r=r=>e(e.s=r);e.O(0,[441,684,358],()=>r(4356)),_N_E=e.O()}]);